<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Gerenciar Produtos | OfertasTop</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        // Configuração do Tailwind CSS (mesma do seu site)
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'brand-primary': '#007BFF',
                        'brand-secondary': '#FFC107',
                        'brand-success': '#28A745',
                        'brand-danger': '#DC3545',
                        'brand-ml': '#FFE600',
                        'brand-magalu': '#0086FF',
                        'brand-shopee': '#FF4D00',
                        'light-bg': '#F8F9FA',
                        'dark-text': '#212529',
                        'medium-text': '#495057',
                    }
                }
            }
        }
    </script>
</head>
<body class="antialiased bg-light-bg text-dark-text">
    <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <div class="flex-shrink-0">
                    <a href="index.html" class="flex items-center space-x-2">
                        <svg class="h-8 w-auto text-brand-primary" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12.75 15.6625L15.001 10.6118L16.9101 13.0899L12.75 15.6625ZM8.99902 13.0899L11.2491 10.6118L13.5 15.6625L8.99902 13.0899ZM11.3901 8.91013L9.08991 12.1118L12.001 16.3882L14.9101 12.1118L11.3901 8.91013Z"/></svg>
                        <span class="text-3xl font-extrabold text-brand-primary">OfertasTop</span>
                        <span class="text-xl font-semibold text-medium-text ml-2">Admin</span>
                    </a>
                </div>
                 <nav>
                    <a href="index.html" class="text-gray-700 hover:text-brand-primary px-3 py-2 rounded-md text-base font-medium transition-colors">Ver Site</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="py-10">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            
            <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h2 class="text-2xl font-bold text-dark-text mb-4">Adicionar Novo Produto</h2>
                <form id="adicionarProdutoForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <input type="text" id="productName" placeholder="Nome do Produto" required class="col-span-1 md:col-span-2 lg:col-span-1 p-2 border border-gray-300 rounded-md">
                    <input type="number" step="0.01" id="productPrice" placeholder="Preço (Ex: 199.90)" required class="p-2 border border-gray-300 rounded-md">
                    <input type="number" step="0.01" id="productOriginalPrice" placeholder="Preço Original (Opcional)" class="p-2 border border-gray-300 rounded-md">
                    <select id="productStore" required class="p-2 border border-gray-300 rounded-md">
                        <option value="">Selecione a Loja</option>
                        <option value="Amazon">Amazon</option>
                        <option value="Mercado Livre">Mercado Livre</option>
                        <option value="Magazine Luiza">Magazine Luiza</option>
                        <option value="Shopee">Shopee</option>
                    </select>
                    <select id="productCategory" required class="p-2 border border-gray-300 rounded-md">
                        <option value="">Selecione a Categoria</option>
                        <option value="eletronicos">Eletrônicos</option>
                        <option value="moda">Moda</option>
                        <option value="casa">Casa</option>
                    </select>
                    <input type="url" id="productImage" placeholder="URL da Imagem" required class="col-span-1 md:col-span-2 p-2 border border-gray-300 rounded-md">
                    <input type="url" id="productAffiliateLink" placeholder="Link de Afiliado" required class="col-span-1 md:col-span-2 p-2 border border-gray-300 rounded-md">
                    <button type="submit" class="col-span-1 md:col-span-2 lg:col-span-3 bg-brand-primary text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition-colors">Salvar Produto</button>
                </form>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold text-dark-text mb-4">Gerenciar Produtos Existentes</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Imagem</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Preço</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Loja</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="listaProdutosAdmin" class="bg-white divide-y divide-gray-200">
                            </tbody>
                    </table>
                </div>
            </div>

        </div>
    </main>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const STORAGE_KEY = 'ofertasTopProducts';

            const form = document.getElementById('adicionarProdutoForm');
            const productListAdmin = document.getElementById('listaProdutosAdmin');

            // --- FUNÇÕES DE GERENCIAMENTO DE PRODUTOS ---

            // Pega produtos do localStorage
            const getProducts = () => {
                const productsJSON = localStorage.getItem(STORAGE_KEY);
                try {
                    return productsJSON ? JSON.parse(productsJSON) : [];
                } catch (e) {
                    return [];
                }
            };

            // Salva produtos no localStorage
            const saveProducts = (products) => {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(products));
            };

            // --- LÓGICA DA PÁGINA ---
            
            // Carrega e exibe a tabela de produtos
            const renderAdminList = () => {
                const products = getProducts();
                productListAdmin.innerHTML = ''; // Limpa a lista antes de renderizar

                if (products.length === 0) {
                     productListAdmin.innerHTML = '<tr><td colspan="5" class="text-center py-4 text-gray-500">Nenhum produto cadastrado. Adicione um no formulário acima.</td></tr>';
                     return;
                }

                products.forEach(product => {
                    const priceFormatted = parseFloat(product.price).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-contain rounded">
                        </td>
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-gray-900">${product.name}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                             <div class="text-sm text-gray-900">${priceFormatted}</div>
                        </td>
                         <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">${product.store}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button data-id="${product.id}" class="remove-btn text-red-600 hover:text-red-900">Remover</button>
                        </td>
                    `;
                    productListAdmin.appendChild(row);
                });
            };

            // Adiciona um novo produto
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const products = getProducts();
                const newProduct = {
                    id: Date.now(), // ID único baseado no timestamp
                    name: document.getElementById('productName').value,
                    price: document.getElementById('productPrice').value,
                    originalPrice: document.getElementById('productOriginalPrice').value || document.getElementById('productPrice').value,
                    store: document.getElementById('productStore').value,
                    category: document.getElementById('productCategory').value,
                    image: document.getElementById('productImage').value,
                    affiliateLink: document.getElementById('productAffiliateLink').value
                };

                products.unshift(newProduct); // Adiciona no início do array
                saveProducts(products);
                
                alert('Produto adicionado com sucesso!');
                form.reset();
                renderAdminList();
            });

            // Remove um produto
            productListAdmin.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-btn')) {
                    if (confirm('Tem certeza que deseja remover este produto?')) {
                        const productId = Number(e.target.dataset.id);
                        let products = getProducts();
                        products = products.filter(product => product.id !== productId);
                        saveProducts(products);
                        renderAdminList();
                    }
                }
            });

            // Renderiza a lista inicial ao carregar a página
            renderAdminList();
        });
    </script>
</body>
</html>